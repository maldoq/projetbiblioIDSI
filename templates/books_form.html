{% extends 'base.html' %}

{% block title %}{% if book %}Modifier{% else %}Ajouter{% endif %} un livre - Bibliothèque{% endblock %}
{% block page_title %}{% if book %}Modifier{% else %}Ajouter{% endif %} un livre{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h3>
            <i class="fas fa-book-{% if book %}medical{% else %}plus{% endif %}"></i>
            {% if book %}Modifier le livre{% else %}Nouveau livre{% endif %}
        </h3>
        <a href="{% url 'books_list' %}" class="btn btn-secondary btn-sm">
            <i class="fas fa-arrow-left"></i>
            Retour au catalogue
        </a>
    </div>
    <div class="card-body">
        <form method="post">
            {% csrf_token %}
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <!-- Colonne gauche -->
                <div>
                    <div class="form-group">
                        <label for="title">
                            Titre du livre <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="title" 
                            name="title" 
                            value="{{ book.titre }}"
                            placeholder="Ex: Le Petit Prince"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="author">
                            Auteur <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="author" 
                            name="author" 
                            value="{{ book.auteur.nom_complet }}"
                            placeholder="Ex: Antoine de Saint-Exupéry"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="isbn">
                            ISBN <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="isbn" 
                            name="isbn" 
                            value="{{ book.isbn }}"
                            placeholder="Ex: 978-2-07-061275-8"
                            required
                        >
                        <span class="form-help">Numéro international normalisé du livre</span>
                    </div>

                    <div class="form-group">
                        <label for="publisher">
                            Éditeur <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="publisher" 
                            name="publisher" 
                            value="{{ book.editeur.nom }}"
                            placeholder="Ex: Gallimard"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="publication_year">
                            Année de publication
                        </label>
                        <input 
                            type="number" 
                            id="publication_year" 
                            name="publication_year" 
                            value="{{ book.annee_publication }}"
                            placeholder="Ex: 1943"
                            min="1800"
                            max="2025"
                        >
                    </div>
                </div>

                <!-- Colonne droite -->
                <div>
                    <div class="form-group">
                        <label for="category">
                            Catégorie <span class="required">*</span>
                        </label>
                        <select id="category" name="category" required>
                            <option value="">-- Sélectionner une catégorie --</option>
                            {% for category in categories %}
                            <option value="{{category.id}}" {% if book.categorie.id == category.id %}selected{% endif %}>{{category.nom}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="language">
                            Langue <span class="required">*</span>
                        </label>
                        <select id="language" name="language" required>
                            <option value="">-- Sélectionner --</option>
                            {% for langue in languages %}
                            <option value="{{ langue.0 }}" {% if book.langue == langue.0 %}selected{% endif %}>
                                {{ langue.1 }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="total_quantity">
                            Quantité totale <span class="required">*</span>
                        </label>
                        <input 
                            type="number" 
                            id="total_quantity" 
                            name="total_quantity" 
                            value="{{ book.quantite }}"
                            placeholder="Ex: 5"
                            min="1"
                            required
                        >
                        <span class="form-help">Nombre total d'exemplaires</span>
                    </div>

                    <div class="form-group">
                        <label for="pages">
                            Nombre de pages
                        </label>
                        <input 
                            type="number" 
                            id="pages" 
                            name="pages" 
                            value="{{ book.nbre_pages }}"
                            placeholder="Ex: 96"
                            min="1"
                        >
                    </div>

                    <div class="form-group">
                        <label for="location">
                            Emplacement
                        </label>
                        <input 
                            type="text" 
                            id="location" 
                            name="location" 
                            value="{{ book.emplacement }}"
                            placeholder="Ex: Étagère A - Rayon 3"
                        >
                        <span class="form-help">Position dans la bibliothèque</span>
                    </div>
                </div>
            </div>

            <!-- Description -->
            <div class="form-group">
                <label for="description">
                    Description / Résumé
                </label>
                <textarea 
                    id="description" 
                    name="description" 
                    placeholder="Brève description du livre..."
                    rows="4"
                >{{ book.resume }}</textarea>
                <span class="form-help">Résumé ou informations complémentaires sur le livre</span>
            </div>

            <!-- Buttons -->
            <div class="btn-group" style="justify-content: flex-end;">
                <a href="{% url 'books_list' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    Annuler
                </a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    {% if book %}Mettre à jour{% else %}Enregistrer{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}